<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="title" content="ooza quest tracker">
    <meta name="theme-color" content="#ffffff">
    <title>Pooks Clan Battle | 1.0.2</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div id="particles-js"></div>
    <div class="container">
      <h1 id="title">PO0K Clan Battle!</h1> Powered by the <a href="https://docs.biggamesapi.io/" style="color:white">Pet Simulator 99 API</a>
      <br>
      <a id="updated">Last updated not now</a>
      <br>
      <a id="clan">Clan Rank: #99 | Clan Points: 99</a>
      <br>
      <table id="overlayzero">
        <thead>
          <tr>
            <th>Quest Challenge</th>
            <th>Progress</th>
            <th>Stars</th>
          </tr>
        </thead>
        <tbody id="questsData">
          <tr>
            <td id="qc0">Fix 99 Bugs</td>
            <td id="p0">0/99</td>
            <td>
              <span id="s0">100</span>
              <img src="star.png" alt="Star" class="star-icon">
            </td>
          </tr>
          <tr>
            <td id="qc1">Fix 99 Bugs</td>
            <td id="p1">0/99</td>
            <td>
              <span id="s1">200</span>
              <img src="star.png" alt="Star" class="star-icon">
            </td>
          </tr>
          <tr>
            <td id="qc2">Fix 99 Bugs</td>
            <td id="p2">0/99</td>
            <td>
              <span id="s2">300</span>
              <img src="star.png" alt="Star" class="star-icon">
            </td>
          </tr>
          <tr>
            <td id="qc3">Fix 99 Bugs</td>
            <td id="p3">0/99</td>
            <td>
              <span id="s3">400</span>
              <img src="star.png" alt="Star" class="star-icon">
            </td>
          </tr>
        </tbody>
        </tbody>
      </table>
      <div id="Contributions"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS('particles-js', {
          "particles": {
            "number": {
              "value": 50,
              "density": {
                "enable": true,
                "value_area": 800
              }
            },
            "color": {
              "value": "#ffffff"
            },
            "shape": {
              "type": "circle",
              "stroke": {
                "width": 0,
                "color": "#000000"
              },
              "polygon": {
                "nb_sides": 5
              },
              "image": {
                "src": "img/github.svg",
                "width": 100,
                "height": 100
              }
            },
            "opacity": {
              "value": 0.5,
              "random": false,
              "anim": {
                "enable": false,
                "speed": 1,
                "opacity_min": 0.1,
                "sync": false
              }
            },
            "size": {
              "value": 3,
              "random": true,
              "anim": {
                "enable": false,
                "speed": 40,
                "size_min": 0.1,
                "sync": false
              }
            },
            "line_linked": {
              "enable": true,
              "distance": 150,
              "color": "#ffffff",
              "opacity": 0.4,
              "width": 1
            },
            "move": {
              "enable": true,
              "speed": 6,
              "direction": "none",
              "random": false,
              "straight": false,
              "out_mode": "out",
              "bounce": false,
              "attract": {
                "enable": false,
                "rotateX": 600,
                "rotateY": 1200
              }
            }
          },
          "interactivity": {
            "detect_on": "canvas",
            "events": {
              "onhover": {
                "enable": true,
                "mode": "repulse"
              },
              "onclick": {
                "enable": true,
                "mode": "push"
              },
              "resize": true
            },
            "modes": {
              "grab": {
                "distance": 400,
                "line_linked": {
                  "opacity": 1
                }
              },
              "bubble": {
                "distance": 400,
                "size": 40,
                "duration": 2,
                "opacity": 8,
                "speed": 3
              },
              "repulse": {
                "distance": 200,
                "duration": 0.4
              },
              "push": {
                "particles_nb": 4
              },
              "remove": {
                "particles_nb": 2
              }
            }
          },
          "retina_detect": true
        });
      </script>
<script>
  document.addEventListener("DOMContentLoaded", run);

  async function getClanDetails(clanName) {
    const url = `${apiUrl}/api/clan/${clanTag}`;
    try {
      const response = await fetch(url);
      const data = await response.json();
      if (!response.ok || data.status !== 'ok') {
        throw new Error(`Failed to fetch details for clan '${clanName}'`);
      }
      return data.data;
    } catch (error) {
      throw new Error(`Error in getClanDetails: ${error.message}`);
    }
  }
</script>

    </div>
    <script>
      const clanTag = "P0OK"
      const apiUrl = "https://biggamesapi.io"
      document.addEventListener("DOMContentLoaded", run);
      let whatOverlay = 0

      setInterval(() => {
        run()
      }, 60000);

      function changeOverlay() {
        if (whatOverlay == 0) {
          whatOverlay = 1
          document.getElementById('overlayzero').hidden = true
          document.getElementById('overlayone').hidden = false
          document.getElementById('title').innerText = "Clan Points Leaderboard"
        } else {
          whatOverlay = 0
          document.getElementById('overlayzero').hidden = false
          document.getElementById('overlayone').hidden = true
          document.getElementById('title').innerText = "Clan Quests Overlay"
        }
        run()
      }

      async function getClanDetails(clanName) {
        const url = `${apiUrl}/api/clan/${clanTag}`;
        try {
          const response = await fetch(url);
          const data = await response.json();
          if (!response.ok || data.status !== 'ok') {
            throw new Error(`Failed to fetch details for clan '${clanName}'`);
          }
          return data.data;
        } catch (error) {
          throw new Error(`Error in getClanDetails: ${error.message}`);
        }
      }

      async function getChallenges() {
        const url = `${apiUrl}/challenges.json`;
        try {
          const response = await fetch(url);
          const data = await response.json();
          if (!response.ok || data.status !== 'ok') {
            throw new Error('Failed to fetch challlenges');
          }
          return data.data;
        } catch (error) {
          throw new Error(`Error in getChallenges: ${error.message}`);
        }
      }

      async function getClans(page, pageSize, sort, sortOrder) {
        const url = `${apiUrl}/api/clans`;
        try {
          const response = await fetch(url);
          const data = await response.json();
          if (!response.ok || data.status !== 'ok') {
            throw new Error('Failed to fetch clans');
          }
          return data.data;
        } catch (error) {
          throw new Error(`Error in getClans: ${error.message}`);
        }
      }

      async function getUsernameFromId(id) {
        const url = `${apiUrl}/api/ids?id=${id}`;
        try {
          const response = await fetch(url);
          const data = await response.json();
          return data;
        } catch (error) {
          throw new Error(`Error in getUsernameFromId: ${error.message}`);
        }
      }

      let clanRank = null

      async function run() {
        if (whatOverlay == 0) {
          getClans().then(clans => {
            clans.sort((a, b) => b.Points - a.Points);
            // Find the position of the clan
            const position = clans.findIndex(clan => clan.Name === clanTag);
            if (position !== -1) {
              clanRank = position + 1
            } else {}
          })

          getClanDetails(clanTag).then(async clanDetails => {
            async function getQuestNameFromType(type) {
              const questTypes = {
                7: "Earn Diamonds",
                9: "Break Diamond Breakables",
                12: "Craft Tier III Potions",
                13: "Craft Tier III Enchants",
                14: "Collect Potions",
                20: "Hatch Best Egg",
                21: "Break Breakables in Best Area",
                22: "Complete Classic Obby",
                23: "Complete the Minefield",
                24: "Complete Atlantis",
                25: "Find Chests in Digsite",
                26: "Catch Fish in the Fishing Minigame",
                27: "Complete Ice Obby",
                29: "Complete Jungle Obby",
                34: "Use Tier IV Potions",
                37: "Fill Coin Jars in Best Area",
                38: "Break Comets in Best Area",
                39: "Break Mini Chests in Best Area",
                40: "Make Gold Pets from Best Egg",
                41: "Make Rainbow Pets from Best Egg",
                42: "Hatch Rare Pets from Best Egg",
                43: "Break Pinatas",
                44: "Break Lucky Blocks in Best Area",
                45: "Break Chests in Advanced Digsite",
                46: "Catch Fish in Advanced Fishing",
                73: "Break Breakables in the Treasure Hideout",
                74: "Consume XP Potions"
              };

              try {
                if (questTypes[type]) {
                  return questTypes[type];
                } else {
                  return "Unknown Quest";
                }
              } catch {
                return "Unknown Quest";
              }
            }

            document.getElementById("qc0").innerText = `${await getQuestNameFromType(clanDetails.Battles.GoalBattleTwo.Goals[0].Type)}`
            document.getElementById("p0").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[0].Progress.toLocaleString()}/${clanDetails.Battles.GoalBattleTwo.Goals[0].Amount.toLocaleString()}`
            document.getElementById("s0").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[0].Stars}`
            document.getElementById("qc1").innerText = `${await getQuestNameFromType(clanDetails.Battles.GoalBattleTwo.Goals[1].Type)}`
            document.getElementById("p1").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[1].Progress.toLocaleString()}/${clanDetails.Battles.GoalBattleTwo.Goals[1].Amount.toLocaleString()}`
            document.getElementById("s1").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[1].Stars}`
            document.getElementById("qc2").innerText = `${await getQuestNameFromType(clanDetails.Battles.GoalBattleTwo.Goals[2].Type)}`
            document.getElementById("p2").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[2].Progress.toLocaleString()}/${clanDetails.Battles.GoalBattleTwo.Goals[2].Amount.toLocaleString()}`
            document.getElementById("s2").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[2].Stars}`
            document.getElementById("qc3").innerText = `${await getQuestNameFromType(clanDetails.Battles.GoalBattleTwo.Goals[3].Type)}`
            document.getElementById("p3").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[3].Progress.toLocaleString()}/${clanDetails.Battles.GoalBattleTwo.Goals[3].Amount.toLocaleString()}`
            document.getElementById("s3").innerText = `${clanDetails.Battles.GoalBattleTwo.Goals[3].Stars}`
            document.getElementById("clan").innerText = `Clan Rank: #${clanRank} | Clan Points: ${Object.values(clanDetails.Battles)[Object.values(clanDetails.Battles).length - 1].Points.toLocaleString()}`
            document.getElementById("updated").innerText = `Last Updated: ${new Date().toLocaleTimeString()}`
          
          }).catch(error => {
            console.error('Error:', error.message);
          });
        }



        }
    </script>
  </body>
</html>